# In Progress ‚Äî –≤ —Ä–∞–±–æ—Ç–µ

> –ó–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è. –ú–∞–∫—Å–∏–º—É–º 3-5 –∑–∞–¥–∞—á –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ñ–æ–∫—É—Å–∞.

---

**–õ–∏–º–∏—Ç WIP:** –ú–∞–∫—Å–∏–º—É–º 5 –∑–∞–¥–∞—á –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.


**D-11: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è HMAC-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ Telegram initData**
**–†–æ–ª—å:** Backend Developer
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–°—Ç–∞—Ç—É—Å:** [ ] ~70% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–æ—Å—Ç–∞–ª–∏—Å—å unit-—Ç–µ—Å—Ç—ã —Å –æ—Ñ–∏—Ü. –≤–µ–∫—Ç–æ—Ä–∞–º–∏)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ `secret_key = HMAC_SHA256(bot_token, "WebAppData")` –≤ `telegram_validator.go` –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.

**üö® –û–ë–ù–ê–†–£–ñ–ï–ù–ù–ê–Ø –û–®–ò–ë–ö–ê:**
–í `services/telegram.go:290` —Ñ—É–Ω–∫—Ü–∏—è `generateSecretKeyForToken()` –∏–º–µ–µ—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ HMAC**:
```go
// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):
h := hmac.New(sha256.New, []byte("WebAppData"))
h.Write([]byte(botToken))

// –ü–†–ê–í–ò–õ–¨–ù–û (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å):
h := hmac.New(sha256.New, []byte(botToken))
h.Write([]byte("WebAppData"))
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- [x] **üî• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ö–†–ò–¢–ò–ß–ï–°–ö–û–ô –û–®–ò–ë–ö–ò**: –ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ `generateSecretKeyForToken()` ‚úÖ
- [ ] **Unit-—Ç–µ—Å—Ç—ã —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏**: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ test vectors –æ—Ç Telegram
- [x] **Negative path —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –¢–µ—Å—Ç—ã —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ‚úÖ
- [x] **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞**: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã ‚úÖ
- [x] **Regression —Ç–µ—Å—Ç—ã**: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ
- [x] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ ‚úÖ

**–§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:**
- `services/auth-service/internal/services/telegram_validator.go`
- `docs/specs/auth-service.md`

---

**L-1: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Inventory Service**
**–†–æ–ª—å:** DevOps/Backend Developer
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π
**–°—Ç–∞—Ç—É—Å:** [ ] ~70% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–î–æ—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ inventory-service - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ middleware.

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–æ—Å—Ç–∞–≤—à–∏–µ—Å—è ~30%):**
- [ ] **–°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ inventory –º–µ—Ç—Ä–∏–∫–∏**: 
  - `inventory_balance_calculation_duration_seconds` - –≤—Ä–µ–º—è —Ä–∞—Å—á–µ—Ç–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å label cache_hit
  - `inventory_daily_balance_created_total` - –ª–µ–Ω–∏–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–Ω–µ–≤–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤
  - `inventory_cache_hit_ratio` - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º
  - `inventory_classifier_conversions_total` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–æ–¥‚ÜîUUID
  - `inventory_insufficient_balance_errors_total` - –æ—à–∏–±–∫–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
  - `inventory_transaction_rollbacks_total` - –æ—Ç–∫–∞—Ç—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏
  - `inventory_service_up` –∏ `inventory_service_start_time_seconds`
- [ ] **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ repositories –∏ services
- [ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ middleware**: –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ `internal/middleware/metrics.go` –Ω–æ–≤—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

**–°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ (~70%):**
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ HTTP, DB, Redis –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ Grafana –¥–∞—à–±–æ—Ä–¥ —Å–æ–∑–¥–∞–Ω —Å 7 –≥—Ä—É–ø–ø–∞–º–∏ –ø–∞–Ω–µ–ª–µ–π
- ‚úÖ 8 –∞–ª–µ—Ä—Ç–æ–≤ –≤ Prometheus –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ HTTP middleware –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

**–§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:**
- `services/inventory-service/pkg/metrics/metrics.go` - —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- `services/inventory-service/internal/service/` - –º–µ—Å—Ç–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫

**–û—Ü–µ–Ω–∫–∞:** 1-1.5 –¥–Ω—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏

---