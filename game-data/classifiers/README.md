# Классификаторы (reference data) в формате YAML

Этот каталог содержит **справочные классификаторы** игры Shard Legends в едином YAML-формате.  
Формат описан в спецификации [`docs/specs/classifier_yaml_format.md`](../../docs/specs/classifier_yaml_format.md).

## Структура каталога

Все классификаторы сгруппированы по смыслу и объединены в четыре агрегированных файла:

| Файл | Содержит классификаторы | Кол-во элементов |
|------|-------------------------|------------------|
| `core_combined.yaml` | `item_class`, `inventory_section`, `operation_type` | 23 |
| `item_types_combined.yaml` | `resource_type`, `reagent_type`, `booster_type`, `tool_type`, `key_type`, `currency_type`, `blueprint_type` | 20 |
| `quality_combined.yaml` | `quality_level`, `tool_quality_levels`, `key_quality_levels` | 15 |
| `collection_combined.yaml` | `collection` | 1 |

Всего элементов классификаторов: **59**.

## Соответствие SQL-миграциям

UUID, `code` и `description` каждого классификатора/элемента полностью совпадают с миграцией `migrations/003_populate_classifiers.up.sql`.  
Это гарантирует идемпотентность: утилиты могут безопасно выполнять `INSERT … ON CONFLICT` без риска дублирования.

## Использование при импорте

1. Скрипт/миграция перебирает файлы `*_combined.yaml`.
2. Для каждого классификатора выполняется upsert самой записи и всех его элементов.  
   Удаление элементов **не требуется**: элементы с новыми UUID/кодами просто добавляются.
3. При необходимости обновляется только поле `description` существующих записей.

## Добавление новых значений

1. Найдите подходящий агрегированный файл.  
2. Добавьте новый элемент в секцию `items`, с уникальным UUID v4 и `code` в `snake_case`.
3. Запустите утилиту загрузки (или создайте SQL-миграцию), чтобы данные появились во всех окружениях.

Пожалуйста, не меняйте существующие UUID — они используются как внешние ключи во многих сервисах. 